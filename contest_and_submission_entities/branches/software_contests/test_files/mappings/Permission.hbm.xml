<?xml version="1.0"?>
<!-- since Module Cockpit Contest Service Enhancement Assembly -->
<!DOCTYPE hibernate-mapping PUBLIC 
	"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping package="com.topcoder.service.studio.permission">
	<class name="Permission" table="user_permission_grant" lazy="true">
		<comment>
			This tables describes permission instance.
		</comment>

		<id name="permissionId" column="user_permission_grant_id" type="long" unsaved-value="-1">
			<generator class="sequence">
				<param name="sequence">PERMISSION_SEQ</param>
			</generator>
		</id>

		<property name="userId" column="user_id"
			not-null="true" />
            
        <property name="userHandle" formula="(SELECT u.handle FROM user u where u.user_id = user_id)"
			not-null="true" />

		<property name="projectId" column="project_id"
			not-null="true" />
            
        <property name="projectName" formula="(NVL((SELECT p.name FROM tc_direct_project p where p.project_id = project_id), (SELECT c.name from contest c where c.contest_id = project_id)))"
			not-null="true" />

		<many-to-one name="permissionType"
			class="com.topcoder.service.studio.permission.PermissionType"
			column="permission_type_id" fetch="select"/>
	</class>
</hibernate-mapping>