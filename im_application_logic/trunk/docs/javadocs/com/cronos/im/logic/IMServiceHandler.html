<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.4.2_13) on Sat May 12 17:03:00 CST 2007 -->
<TITLE>
IMServiceHandler (Topcoder Software)
</TITLE>

<META NAME="keywords" CONTENT="com.cronos.im.logic.IMServiceHandler class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="IMServiceHandler (Topcoder Software)";
}
</SCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<table border=0 cellpadding=0 cellspacing=2><tr><td><font class=tcoder2>[ </font><font class=tcoder1>TOP</font><font class=tcoder2>CODER </font><font class=tcoder2>]</font></td><td><font class=tcoder4>?</font></td></tr><tr><td class=tcoder3 align=center><font class=tcoder3>SOFTWARE</font></td></tr></table></EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../com/cronos/im/logic/IMLogger.html" title="class in com.cronos.im.logic"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../com/cronos/im/logic/MessagePoolDetector.html" title="class in com.cronos.im.logic"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="IMServiceHandler.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>

</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
com.cronos.im.logic</FONT>
<BR>
Class IMServiceHandler</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by"><B>com.cronos.im.logic.IMServiceHandler</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD>com.topcoder.service.ServiceHandler</DD>
</DL>
<HR>
<DL>
<DT>public class <B>IMServiceHandler</B><DT>extends java.lang.Object<DT>implements com.topcoder.service.ServiceHandler</DL>

<P>
<p>
 This class handles main service logic for the IM application. This class implements the
 ServiceHandler interface and will be plugged into the ServiceEngine.
 </p>
 <p>
 There are two phases of service logic in this class:
 </p>
 <p>
 1. To-be-serviced logic happens when both requester and responder is available for specific
 category.
 </p>
 <p>
 2. Serviced logic deals with the actual service logic.
 </p>
 <p>
 Thread-safety: This class is thread-safe. Although the responderMap variable may be changed, but
 it is synchronized and thus thread-safe.
 </p>
<P>

<P>
<DL>
<DT><B>Version:</B></DT>
  <DD>1.0</DD>
<DT><B>Author:</B></DT>
  <DD>justforplay, TCSDEVELOPER</DD>
</DL>
<HR>

<P>
<!-- ======== NESTED CLASS SUMMARY ======== -->


<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Field Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#DEFAULT_NAMESPACE">DEFAULT_NAMESPACE</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Represents the default namespace to load the configuration when no namespace is provided in
 the constructor.
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#SESSION_ID_KEY">SESSION_ID_KEY</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Represents the key for the session id.
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#USER_ID_KEY">USER_ID_KEY</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Represents the key for the user id.
 </TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#IMServiceHandler(com.topcoder.chat.session.ChatSessionManager, com.cronos.im.messenger.Messenger, com.topcoder.chat.status.ChatSessionStatusTracker, com.topcoder.chat.status.ChatUserStatusTracker, com.cronos.im.logic.IMLogger)">IMServiceHandler</A></B>(com.topcoder.chat.session.ChatSessionManager&nbsp;sessionManager,
                 com.cronos.im.messenger.Messenger&nbsp;messenger,
                 com.topcoder.chat.status.ChatSessionStatusTracker&nbsp;sessionStatusTracker,
                 com.topcoder.chat.status.ChatUserStatusTracker&nbsp;userStatusTracker,
                 <A HREF="../../../../com/cronos/im/logic/IMLogger.html" title="class in com.cronos.im.logic">IMLogger</A>&nbsp;logger)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Constructor to create service handler with given parameters. </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#IMServiceHandler(com.topcoder.chat.session.ChatSessionManager, com.cronos.im.messenger.Messenger, com.topcoder.chat.status.ChatSessionStatusTracker, com.topcoder.chat.status.ChatUserStatusTracker, com.cronos.im.logic.IMLogger, java.lang.String)">IMServiceHandler</A></B>(com.topcoder.chat.session.ChatSessionManager&nbsp;sessionManager,
                 com.cronos.im.messenger.Messenger&nbsp;messenger,
                 com.topcoder.chat.status.ChatSessionStatusTracker&nbsp;sessionStatusTracker,
                 com.topcoder.chat.status.ChatUserStatusTracker&nbsp;userStatusTracker,
                 <A HREF="../../../../com/cronos/im/logic/IMLogger.html" title="class in com.cronos.im.logic">IMLogger</A>&nbsp;logger,
                 java.lang.String&nbsp;namespace)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Construcotr to create service handler with given parameters. </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#IMServiceHandler(com.topcoder.chat.session.ChatSessionManager, com.cronos.im.messenger.Messenger, com.topcoder.chat.status.ChatSessionStatusTracker, com.topcoder.chat.status.ChatUserStatusTracker, long, long, com.cronos.im.logic.IMLogger)">IMServiceHandler</A></B>(com.topcoder.chat.session.ChatSessionManager&nbsp;sessionManager,
                 com.cronos.im.messenger.Messenger&nbsp;messenger,
                 com.topcoder.chat.status.ChatSessionStatusTracker&nbsp;sessionStatusTracker,
                 com.topcoder.chat.status.ChatUserStatusTracker&nbsp;userStatusTracker,
                 long&nbsp;responderWaitTime,
                 long&nbsp;checkResponseInterval,
                 <A HREF="../../../../com/cronos/im/logic/IMLogger.html" title="class in com.cronos.im.logic">IMLogger</A>&nbsp;logger)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Construcotr to create service handler with given parameters.
 </TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Method Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#clearAllResponders()">clearAllResponders</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Clears all the responders that are cached in this ServiceHandler.
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;com.topcoder.chat.session.ChatSessionManager</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#getChatSessionManager()">getChatSessionManager</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Gets chat session manager instance used in this service handler.
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;com.topcoder.chat.status.ChatSessionStatusTracker</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#getChatSessionStatusTracker()">getChatSessionStatusTracker</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Gets chat session status tracker used in this service handler.
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;com.topcoder.chat.status.ChatUserStatusTracker</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#getChatUserStatusTracker()">getChatUserStatusTracker</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Gets chat user status tracker used in this service handler.
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#getCheckResponseInterval()">getCheckResponseInterval</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Gets time interval in milliseconds for the thread to sleep when checking whether a responder
 is found.
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;com.cronos.im.messenger.Messenger</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#getMessenger()">getMessenger</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Gets messager used to send messages in this service handler.
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;com.topcoder.service.ServiceElement</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#getResponder(com.topcoder.service.ServiceElement, com.topcoder.service.Category)">getResponder</A></B>(com.topcoder.service.ServiceElement&nbsp;requester,
             com.topcoder.service.Category&nbsp;category)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Gets the corresponding responder for the requester and category.
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#getResponderWaitTime()">getResponderWaitTime</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Gets responder wait time in milliseconds. </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#onServiced(com.topcoder.service.ServiceEvent)">onServiced</A></B>(com.topcoder.service.ServiceEvent&nbsp;serviceEvent)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 This method is invoked when both requester and responder becomes availabe for the category.
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#onToBeServiced(com.topcoder.service.ServiceEvent)">onToBeServiced</A></B>(com.topcoder.service.ServiceEvent&nbsp;serviceEvent)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Invoked in the "To-Be-Serviced" phase. </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../com/cronos/im/logic/IMServiceHandler.html#setResponder(com.topcoder.service.ServiceElement, com.topcoder.service.Category, com.topcoder.service.ServiceElement)">setResponder</A></B>(com.topcoder.service.ServiceElement&nbsp;requester,
             com.topcoder.service.Category&nbsp;category,
             com.topcoder.service.ServiceElement&nbsp;responder)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the corresponding responder for the requester and category.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TD><B>Methods inherited from class java.lang.Object</B></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Field Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="DEFAULT_NAMESPACE"><!-- --></A><H3>
DEFAULT_NAMESPACE</H3>
<PRE>
public static final java.lang.String <B>DEFAULT_NAMESPACE</B></PRE>
<DL>
<DD><p>
 Represents the default namespace to load the configuration when no namespace is provided in
 the constructor.
 </p>
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../constant-values.html#com.cronos.im.logic.IMServiceHandler.DEFAULT_NAMESPACE">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="USER_ID_KEY"><!-- --></A><H3>
USER_ID_KEY</H3>
<PRE>
public static final java.lang.String <B>USER_ID_KEY</B></PRE>
<DL>
<DD><p>
 Represents the key for the user id.
 </p>
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../constant-values.html#com.cronos.im.logic.IMServiceHandler.USER_ID_KEY">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="SESSION_ID_KEY"><!-- --></A><H3>
SESSION_ID_KEY</H3>
<PRE>
public static final java.lang.String <B>SESSION_ID_KEY</B></PRE>
<DL>
<DD><p>
 Represents the key for the session id.
 </p>
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../constant-values.html#com.cronos.im.logic.IMServiceHandler.SESSION_ID_KEY">Constant Field Values</A></DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="IMServiceHandler(com.topcoder.chat.session.ChatSessionManager, com.cronos.im.messenger.Messenger, com.topcoder.chat.status.ChatSessionStatusTracker, com.topcoder.chat.status.ChatUserStatusTracker, com.cronos.im.logic.IMLogger)"><!-- --></A><H3>
IMServiceHandler</H3>
<PRE>
public <B>IMServiceHandler</B>(com.topcoder.chat.session.ChatSessionManager&nbsp;sessionManager,
                        com.cronos.im.messenger.Messenger&nbsp;messenger,
                        com.topcoder.chat.status.ChatSessionStatusTracker&nbsp;sessionStatusTracker,
                        com.topcoder.chat.status.ChatUserStatusTracker&nbsp;userStatusTracker,
                        <A HREF="../../../../com/cronos/im/logic/IMLogger.html" title="class in com.cronos.im.logic">IMLogger</A>&nbsp;logger)
                 throws <A HREF="../../../../com/cronos/im/logic/IMConfigurationException.html" title="class in com.cronos.im.logic">IMConfigurationException</A></PRE>
<DL>
<DD><p>
 Constructor to create service handler with given parameters. "responder_wait_time" and
 "check_response_interval" are loaded from default namespace.
 </p>
<P>
<DT><B>Parameters:</B><DD><CODE>sessionManager</CODE> - chat session manager. Can't be null<DD><CODE>messenger</CODE> - messenger used to send the message. Can't be null.<DD><CODE>sessionStatusTracker</CODE> - chat session status tracker used to update the session status. Can't be null.<DD><CODE>userStatusTracker</CODE> - chat user status tracker used to update the user status. Can't be null.<DD><CODE>logger</CODE> - logger used to log the messages. Can be null.
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if any argument except the logger is null or the responderWaitTime or
                checkResponseInterval is negative.
<DD><CODE><A HREF="../../../../com/cronos/im/logic/IMConfigurationException.html" title="class in com.cronos.im.logic">IMConfigurationException</A></CODE> - if the configuration is incorrect.</DL>
<HR>

<A NAME="IMServiceHandler(com.topcoder.chat.session.ChatSessionManager, com.cronos.im.messenger.Messenger, com.topcoder.chat.status.ChatSessionStatusTracker, com.topcoder.chat.status.ChatUserStatusTracker, com.cronos.im.logic.IMLogger, java.lang.String)"><!-- --></A><H3>
IMServiceHandler</H3>
<PRE>
public <B>IMServiceHandler</B>(com.topcoder.chat.session.ChatSessionManager&nbsp;sessionManager,
                        com.cronos.im.messenger.Messenger&nbsp;messenger,
                        com.topcoder.chat.status.ChatSessionStatusTracker&nbsp;sessionStatusTracker,
                        com.topcoder.chat.status.ChatUserStatusTracker&nbsp;userStatusTracker,
                        <A HREF="../../../../com/cronos/im/logic/IMLogger.html" title="class in com.cronos.im.logic">IMLogger</A>&nbsp;logger,
                        java.lang.String&nbsp;namespace)
                 throws <A HREF="../../../../com/cronos/im/logic/IMConfigurationException.html" title="class in com.cronos.im.logic">IMConfigurationException</A></PRE>
<DL>
<DD><p>
 Construcotr to create service handler with given parameters. "responder_wait_time" and
 "check_response_interval" are loaded from the given namespace.
 </p>
<P>
<DT><B>Parameters:</B><DD><CODE>sessionManager</CODE> - chat session manager. Can't be null<DD><CODE>messenger</CODE> - messenger used to send the message. Can't be null.<DD><CODE>sessionStatusTracker</CODE> - chat session status tracker used to update the session status. Can't be null.<DD><CODE>userStatusTracker</CODE> - chat user status tracker used to update the user status. Can't be null.<DD><CODE>logger</CODE> - logger used to log the messages. Can be null.<DD><CODE>namespace</CODE> - namespace to load the configuration. Can't be null or empty.
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if any argument except the logger is null or the responderWaitTime or
                checkResponseInterval is negative, or the namespace is empty.
<DD><CODE><A HREF="../../../../com/cronos/im/logic/IMConfigurationException.html" title="class in com.cronos.im.logic">IMConfigurationException</A></CODE> - if the configuration is incorrect.</DL>
<HR>

<A NAME="IMServiceHandler(com.topcoder.chat.session.ChatSessionManager, com.cronos.im.messenger.Messenger, com.topcoder.chat.status.ChatSessionStatusTracker, com.topcoder.chat.status.ChatUserStatusTracker, long, long, com.cronos.im.logic.IMLogger)"><!-- --></A><H3>
IMServiceHandler</H3>
<PRE>
public <B>IMServiceHandler</B>(com.topcoder.chat.session.ChatSessionManager&nbsp;sessionManager,
                        com.cronos.im.messenger.Messenger&nbsp;messenger,
                        com.topcoder.chat.status.ChatSessionStatusTracker&nbsp;sessionStatusTracker,
                        com.topcoder.chat.status.ChatUserStatusTracker&nbsp;userStatusTracker,
                        long&nbsp;responderWaitTime,
                        long&nbsp;checkResponseInterval,
                        <A HREF="../../../../com/cronos/im/logic/IMLogger.html" title="class in com.cronos.im.logic">IMLogger</A>&nbsp;logger)</PRE>
<DL>
<DD><p>
 Construcotr to create service handler with given parameters.
 </p>
<P>
<DT><B>Parameters:</B><DD><CODE>sessionManager</CODE> - chat session manager. Can't be null<DD><CODE>messenger</CODE> - messenger used to send the message. Can't be null.<DD><CODE>sessionStatusTracker</CODE> - chat session status tracker used to update the session status. Can't be null.<DD><CODE>userStatusTracker</CODE> - chat user status tracker used to update the user status. Can't be null.<DD><CODE>responderWaitTime</CODE> - responder waiting time when requesting the responder to service. Should not be
            negative.<DD><CODE>checkResponseInterval</CODE> - time interval used to sleep the thread when checking the response. Can't be
            negative value.<DD><CODE>logger</CODE> - logger used to log the messages. Can be null.
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if any argument except the logger is null or the responderWaitTime or
                checkResponseInterval is negative.</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Method Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="onToBeServiced(com.topcoder.service.ServiceEvent)"><!-- --></A><H3>
onToBeServiced</H3>
<PRE>
public void <B>onToBeServiced</B>(com.topcoder.service.ServiceEvent&nbsp;serviceEvent)
                    throws com.topcoder.service.ServiceHandleException</PRE>
<DL>
<DD><p>
 Invoked in the "To-Be-Serviced" phase. The logic is as following (such logic is run with a
 background thread):
 </p>
 <p>
 1. Request the responder to the session.
 </p>
 <p>
 2. If the responder does not accept the request in a configurable period of time, request the
 remaining responders of the same category to the session.
 </p>
 <p>
 3. If still no responder accepts the request in that period of time, move it to the servicing
 state with no responder.
 </p>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE>onToBeServiced</CODE> in interface <CODE>com.topcoder.service.ServiceHandler</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>serviceEvent</CODE> - service event object used. Can't be null.
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if any argument is null.
<DD><CODE>com.topcoder.service.ServiceHandleException</CODE> - this exception is never thrown.</DL>
</DD>
</DL>
<HR>

<A NAME="onServiced(com.topcoder.service.ServiceEvent)"><!-- --></A><H3>
onServiced</H3>
<PRE>
public void <B>onServiced</B>(com.topcoder.service.ServiceEvent&nbsp;serviceEvent)
                throws com.topcoder.service.ServiceHandleException</PRE>
<DL>
<DD><p>
 This method is invoked when both requester and responder becomes availabe for the category.
 The logic is as following:
 </p>
 <p>
 Invoked when the service is started.
 </p>
 <p>
 1. If there is a responder, add the responder to session, and update the session status to
 OPEN. Post Session Unavailable Message to other responders requested before. Depending on the
 implementation, this should also notify the handler that some responder accepts the request.
 </p>
 <p>
 2. If there is no responder, post Session Unavailable Message to the requester to notify him
 service is not available. Remove the requester from session. Change the user status to
 OFFLINE.
 </p>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE>onServiced</CODE> in interface <CODE>com.topcoder.service.ServiceHandler</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>serviceEvent</CODE> - service event object used in this phase. Can't be null. And the responder in this
            ServiceEvent should be the one that is in the responderMap.
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if the argument is null or the responder is not the one that is in the
             responderMap
<DD><CODE>com.topcoder.service.ServiceHandleException</CODE> - if any exception occurs.</DL>
</DD>
</DL>
<HR>

<A NAME="getResponder(com.topcoder.service.ServiceElement, com.topcoder.service.Category)"><!-- --></A><H3>
getResponder</H3>
<PRE>
public com.topcoder.service.ServiceElement <B>getResponder</B>(com.topcoder.service.ServiceElement&nbsp;requester,
                                                        com.topcoder.service.Category&nbsp;category)</PRE>
<DL>
<DD><p>
 Gets the corresponding responder for the requester and category.
 </p>
 <p>
 Null value is returned if no responder is found.
 </p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>requester</CODE> - requester of the service. Can't be null.<DD><CODE>category</CODE> - category of the service. Can't be null.
<DT><B>Returns:</B><DD>responder of the service for the requester and category. Null is returned if no
         responder is found.
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if the requester or category is null.</DL>
</DD>
</DL>
<HR>

<A NAME="setResponder(com.topcoder.service.ServiceElement, com.topcoder.service.Category, com.topcoder.service.ServiceElement)"><!-- --></A><H3>
setResponder</H3>
<PRE>
public void <B>setResponder</B>(com.topcoder.service.ServiceElement&nbsp;requester,
                         com.topcoder.service.Category&nbsp;category,
                         com.topcoder.service.ServiceElement&nbsp;responder)</PRE>
<DL>
<DD>Sets the corresponding responder for the requester and category.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>requester</CODE> - requester of the service. Can't be null.<DD><CODE>category</CODE> - category of the service. Can't be null.<DD><CODE>responder</CODE> - actual responder of this service handler for the requester and category.
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if any argument is null.</DL>
</DD>
</DL>
<HR>

<A NAME="getChatSessionManager()"><!-- --></A><H3>
getChatSessionManager</H3>
<PRE>
public com.topcoder.chat.session.ChatSessionManager <B>getChatSessionManager</B>()</PRE>
<DL>
<DD><p>
 Gets chat session manager instance used in this service handler.
 </p>
 <p>
 The return value will never be null.
 </p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>chat session manager instance used in this service handler.</DL>
</DD>
</DL>
<HR>

<A NAME="getMessenger()"><!-- --></A><H3>
getMessenger</H3>
<PRE>
public com.cronos.im.messenger.Messenger <B>getMessenger</B>()</PRE>
<DL>
<DD><p>
 Gets messager used to send messages in this service handler.
 </p>
 <p>
 The return value will never be null.
 </p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>messenger used in this service handler.</DL>
</DD>
</DL>
<HR>

<A NAME="getChatSessionStatusTracker()"><!-- --></A><H3>
getChatSessionStatusTracker</H3>
<PRE>
public com.topcoder.chat.status.ChatSessionStatusTracker <B>getChatSessionStatusTracker</B>()</PRE>
<DL>
<DD><p>
 Gets chat session status tracker used in this service handler.
 </p>
 <p>
 The return value will never be null.
 </p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>chat session status tracker used in this service handler.</DL>
</DD>
</DL>
<HR>

<A NAME="getChatUserStatusTracker()"><!-- --></A><H3>
getChatUserStatusTracker</H3>
<PRE>
public com.topcoder.chat.status.ChatUserStatusTracker <B>getChatUserStatusTracker</B>()</PRE>
<DL>
<DD><p>
 Gets chat user status tracker used in this service handler.
 </p>
 <p>
 The return value will never be null.
 </p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>chat user status tracker used in this service handler.</DL>
</DD>
</DL>
<HR>

<A NAME="getResponderWaitTime()"><!-- --></A><H3>
getResponderWaitTime</H3>
<PRE>
public long <B>getResponderWaitTime</B>()</PRE>
<DL>
<DD><p>
 Gets responder wait time in milliseconds. This is the waiting time for a responder to accept
 the requester.
 </p>
 <p>
 The return value will be not-negative long value.
 </p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>responder wait time.</DL>
</DD>
</DL>
<HR>

<A NAME="getCheckResponseInterval()"><!-- --></A><H3>
getCheckResponseInterval</H3>
<PRE>
public long <B>getCheckResponseInterval</B>()</PRE>
<DL>
<DD><p>
 Gets time interval in milliseconds for the thread to sleep when checking whether a responder
 is found.
 </p>
 <p>
 The return value will be not-negative long value.
 </p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>time interval in milliseconds for the thread to sleep when checking whether a
         responder is found</DL>
</DD>
</DL>
<HR>

<A NAME="clearAllResponders()"><!-- --></A><H3>
clearAllResponders</H3>
<PRE>
public void <B>clearAllResponders</B>()</PRE>
<DL>
<DD><p>
 Clears all the responders that are cached in this ServiceHandler.
 </p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<table border=0 cellpadding=0 cellspacing=2><tr><td><font class=tcoder2>[ </font><font class=tcoder1>TOP</font><font class=tcoder2>CODER </font><font class=tcoder2>]</font></td><td><font class=tcoder4>?</font></td></tr><tr><td class=tcoder3 align=center><font class=tcoder3>SOFTWARE</font></td></tr></table></EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../com/cronos/im/logic/IMLogger.html" title="class in com.cronos.im.logic"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../com/cronos/im/logic/MessagePoolDetector.html" title="class in com.cronos.im.logic"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="IMServiceHandler.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>

</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<font class=tcoder5>Contact TopCoder Software at <a href='http://software.topcoder.com'>software.topcoder.com</a></font>
</BODY>
</HTML>
