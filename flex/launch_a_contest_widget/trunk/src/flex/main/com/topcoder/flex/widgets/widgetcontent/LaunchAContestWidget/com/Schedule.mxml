<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" width="100%" height="100%"
          horizontalScrollPolicy="off" verticalScrollPolicy="off" creationComplete="init()">
    <mx:Script>
        <![CDATA[
        	import mx.controls.Alert;
        	import com.topcoder.flex.widgets.widgetcontent.LaunchAContestWidget.LaunchWidget;
            public var mainWidget:LaunchWidget;
            
            public function initData():void{
            	termCheckBox.selected = false;
            	
            	var startDate:Date = null;
            	var endDate:Date = null;
            	
            	var startTime:Object = mainWidget.competition.startTime;
            	var endTime:Object = mainWidget.competition.endTime;
            	
            	if (startTime != null){
	            	var startDateStr:String = mainWidget.competition.startTime[0] as String;
	            	
	            	if (startDateStr!=null){
	            		startDate = DateUtil.parseFromString(startDateStr);
	            	}
            	}
            	
            	if (endTime != null){
	            	var endDateStr:String = mainWidget.competition.endTime[0] as String;
	            	
	            	if (endDateStr!=null){
	            		endDate = DateUtil.parseFromString(endDateStr);
	            	}
            	}
            	
            	dfStart.selectedDate = startDate;
            	dfEnd.selectedDate = endDate;
            	
            	setTimeControl(CmbHourStart, CmbMinuteStart, AMPMStart, startDate);
            	setTimeControl(CmbHourEnd, CmbMinuteEnd, AMPMEnd, endDate);
            	
            	launchCheckBox.selected = mainWidget.competition.contestData.launchImmediately;
            }
            
            public function validateFields():Boolean{
            	if (dfStart.selectedDate == null){
            		Alert.show("Start date not selected");
            		return false;
            	}
            	
            	if (dfEnd.selectedDate == null){
            		Alert.show("End date not selected");
            		return false;
            	}
            	
            	var current:Date = new Date();
            	var startDate:Date = getAssembleDate(dfStart, CmbHourStart, CmbMinuteStart, AMPMStart);
            	if (startDate.time<=current.time){
            		Alert.show("Start date must be in future");
            		return false;
            	}
            	
            	var endDate:Date = getAssembleDate(dfEnd, CmbHourEnd, CmbMinuteEnd, AMPMEnd);
            	if (endDate.time <= startDate.time){
            		Alert.show("End date must be after start date");
            		return false;
            	}
            	
            	if (termCheckBox.selected == false){
            		Alert.show("Please agree to TopCoder Direct Terms");
            		return false;
            	}
            	
            	updateData();
            	return true;
            }
            
            private function getAssembleDate(dateField:DateField, hourComb:ComboBox, minuteComb:ComboBox, ampm:RadioButtonGroup):Date{
            	var result:Date = dateField.selectedDate;
            	var hour:int = Number(hourComb.value);
            	if (ampm.selectedValue == "PM"){
            		hour = hour + 12;
            	}
            	
            	result.setHours(hour, Number(minuteComb.value), 0, 0);
            	
            	return result;
            }
            
            private function updateData():void{
            	var start:Date = getAssembleDate(dfStart, CmbHourStart, CmbMinuteStart, AMPMStart);
            	var end:Date = getAssembleDate(dfEnd, CmbHourEnd, CmbMinuteEnd, AMPMEnd);
            	
            	var startDate:String = DateUtil.toString(start);
            	var endDate:String = DateUtil.toString(end);
            	
            	mainWidget.competition.startTime = startDate;
            	mainWidget.competition.endTime = endDate;
            	mainWidget.competition._startTime = startDate;
            	mainWidget.competition._endTime = endDate;
            	
            	mainWidget.competition.contestData.launchDateAndTime = startDate;
            	mainWidget.competition.contestData.winnerAnnoucementDeadline = endDate;
            	
            	mainWidget.competition.contestData.launchImmediately = launchCheckBox.selected;
            	mainWidget.competition.contestData.durationInHours  = Number(((end.time - start.time) / 3600000).toFixed(0));
            }
            
            private function setTimeControl(hourComb:ComboBox, minuteComb:ComboBox, ampm:RadioButtonGroup, date:Date):void{
            	if (date == null){
            		hourComb.selectedIndex = 0;
            		minuteComb.selectedIndex = 0;
            		ampm.selectedValue = "AM";
            		return;
            	}
            	
            	var hour:int = date.getHours();
            	var am:Boolean = true;
            	if (hour>12){
            		hour = hour - 12;
            		am = false;
            	}
            	
            	hourComb.selectedIndex = hour;
            	minuteComb.selectedIndex = date.getMinutes();
            	if (am){
            		ampm.selectedValue = "AM";
            	} else{
            		ampm.selectedValue = "PM";
            	}
            }
            
            
            
            private function init():void {
                var hourData:Array = new Array();
            	for(var i:Number = 1; i <= 12; i++){
            		var o:Object = new Object();
            		o.label = i.toString();
            		o.data = i;
            		hourData.push(o);
            	}
            	var minuteData:Array = new Array();
            	for (i = 0; i <= 59; i++){
            		var o1:Object = new Object();
                    if (i < 10)
                        o1.label = '0'+i.toString();
                    else
                        o1.label = i.toString();
                    o1.data = i;
                    minuteData.push(o1);
            	}
                CmbHourStart.dataProvider = hourData;
                CmbMinuteStart.dataProvider = minuteData;
                CmbHourEnd.dataProvider = hourData;
                CmbMinuteEnd.dataProvider = minuteData;
            }
            private function showfileDecsHint():void {
                    
            }
        ]]>
    </mx:Script>
    <mx:VBox paddingLeft="2" width="100%">
        <mx:Label text="Set the Contest Schedule" fontWeight="bold" fontSize="12"/>
        <mx:Text width="100%" id="attachFiles">
            <mx:htmlText>
<![CDATA[When scheduling your contest, consider its complexity and other competitions running at the same time. Keep in mind that you want to allow enough time for competitors to find your contest and put their best effort towards your work. If you're running a short contest, consider a higher prize amount to bring attention to it and increase your likelihood for more and better submissions.
<br>
For your chosen contest type - <b>Application Front End Design</b> - the suggested timelines are:<br>
- Minimum Allowable Time: 2-3 days<br>
- Average Timeframes: 4-5 days<br>
- High Complexity: 6 days and beyond<br>
<br>
<b>** NOTE:</b> Your contest will only launch at your selected date and time IF payment has been made. Otherwise, it will launch when payment is received. **]]>
           </mx:htmlText>
        </mx:Text>
        <mx:Spacer height="5"/>
        <mx:VBox paddingLeft="10">
            <mx:HBox verticalAlign="middle">
                <mx:Label text="Start Date:" fontWeight="bold"/>
                <mx:DateField id="dfStart" yearNavigationEnabled="true" width="116"/>
                <mx:Spacer width="10"/>
                <mx:CheckBox id="launchCheckBox" label="Launch Immediately" selected="true"/>
            </mx:HBox>
            <mx:HBox verticalAlign="middle">
                <mx:Label text="Start Time:" fontWeight="bold"/>
                <mx:Label text="Hour:"/>
                <mx:ComboBox id="CmbHourStart" width="57" />
                <mx:Label text="Minute:"/>
                <mx:ComboBox id="CmbMinuteStart" width="57" />
                <mx:RadioButtonGroup id="AMPMStart" />
                <mx:RadioButton groupName="AMPMStart" id="amStart" label="AM" value="AM" selected="true"/>
                <mx:RadioButton groupName="AMPMStart" id="pmStart" label="PM" value="PM"/>
                <mx:Text id="timezoneStart" text="ET(UMT-5)"/>
            </mx:HBox>
            <mx:Spacer height="5"/>
            <mx:HBox verticalAlign="middle">
                <mx:Label text="End Date:  " fontWeight="bold"/>
                <mx:DateField id="dfEnd" yearNavigationEnabled="true" width="116"/>
            </mx:HBox>
            <mx:HBox verticalAlign="middle">
                <mx:Label text="End Time:  " fontWeight="bold"/>
                <mx:Label text="Hour:"/>
                <mx:ComboBox id="CmbHourEnd" width="57" />
                <mx:Label text="Minute:"/>
                <mx:ComboBox id="CmbMinuteEnd" width="57" />
                <mx:RadioButtonGroup id="AMPMEnd" />
                <mx:RadioButton groupName="AMPMEnd" id="amEnd" label="AM" value="AM" selected="true"/>
                <mx:RadioButton groupName="AMPMEnd" id="pmEnd" label="PM" value="PM"/>
                <mx:Text id="timezoneEnd" text="ET(UMT-5)"/>
            </mx:HBox>
        </mx:VBox>
        <mx:Spacer height="25"/>
        <mx:VBox verticalGap="0">
            <mx:Label text="Terms and Conditions" fontWeight="bold" fontSize="12"/>
            <mx:Text text="Please read TopCoder's Term &amp; Conditions and indicate that you understand and agree."/>
            <mx:TextArea width="100%" height="120">
            	<mx:htmlText>
<![CDATA[                                     <font color="#000000" size="13">TopCoder Direct Terms</font>

These TopCoder Direct Terms ("Agreement") are an agreement between you and TopCoder, Inc. ("TopCoder," "we," "us," or "our"). You means either yourself personally, or the company on the behalf of whom you are requesting Competition Services (defined below). Each of you and TopCoder are a party to this Agreement and TopCoder and you are the parties. This Agreement governs your use of the TopCoder Direct service ("Service"). This Agreement is in addition to the Terms of Use applicable to the TopCoder website. 

The Service allows customers to hold competitions for the development of graphics and design-related material. TopCoder makes no guarantee about the reliability, quality, performance, accuracy, or timeliness of the Service or the results obtained from the Service. You understand that any security mechanisms provided by the Service have inherent limitations and that you are responsible for determining whether the Service meets your needs. 

You represent that you are at least 18 years old. Your use of the Service is conditioned on your acceptance without modification of all of the terms and conditions, rules, conditions, and notices on the TopCoder website, including without limitation this Agreement, as may be modified by TopCoder. TopCoder reserves the right, in its discretion, to change or modify all or any part of this Agreement at any time, effective immediately upon publish to the TopCoder website. The most current version of this Agreement can be viewed by clicking on the "Terms of Use" link on the TopCoder Direct web site. If at any time you do not agree to accept and abide by this Agreement, you should not access or use the Service. 

PRIVACY
In order to operate and provide the Service, we collect certain information about you. We use and protect that information as described in the TopCoder Privacy Policy, available at: http://www.topcoder.com/tc?module=Static&d1=about&d2=privacy

1. SERVICES.
1.1 Custom Competitions. TopCoder will conduct online competitions for you among members of TopCoder’s community as designed by you on the TopCoder web site and as approved and agreed to by TopCoder (“Competition Services”). TopCoder shall have the right, but not the obligation, to review all competition documents (e.g., specifications, contest rules and requirements, prizes, etc.) and may require that you make such changes as TopCoder deems necessary in TopCoder’s sole discretion to maintain the integrity of the competitions and the platform. TopCoder reserves the right to terminate any online competition, for any reason or no reason, in its sole discretion, whether or not TopCoder has reviewed the competition documents.

1.2 Your Use of the Competition Services. In addition to the restrictions provided in the TopCoder Terms of Use, You agree that you will not:

Fail to pay for competitions initiated by you or for content used by you; 
Manipulate the prize for a competition; 
Circumvent or manipulate the fee structure, billing process or fees owed to TopCoder; 
Transfer your account to another party without TopCoder’s prior written consent; 
Copy, modify, or transfer content from the Service or any information protected by copyright and/or trademark laws except as explicitly permitted under this Agreement; 
Use any Third Party Content in the Service which is protected by copyright and/or trademark laws unless you are able to demonstrate the possession of the necessary rights and/or licenses to such content; 
Take any action that imposes or may impose (in our sole discretion) an unreasonable or disproportionately large load on our infrastructure; 
Interfere or attempt to interfere with the proper working of the Competition Services or any activity conducted on the web site; 
Harvest or otherwise collect information about users without the consent of TopCoder and the users. 
Engage or act in a dishonest or unfair manner, or in bad faith. 
Modify, publish, transmit, transfer or sell, reproduce, create derivative works from, distribute, perform, display, reverse engineer or in any way exploit any of the content on the web site or as part of the Competition Services except as explicitly permitted under this Agreement. 
1.3 Transfer of Deliverables. Upon payment in full of all outstanding invoices, all work product other than Third-Party Content and Licensed Content, developed in the course of Competition Services and Consulting Services and delivered to you under this Agreement (“Deliverables”) shall be owned by you. TopCoder agrees to assign to you all of its right, title, and interest in and to such Deliverables, subject to payment of all fees. 

1.4 Licensed Content. In the event you use or require content or software designated by TopCoder as owned or licensed by TopCoder (“Licensed Content”), whether from a TopCoder software component, widget, photo, or design catalog or otherwise, in any competition, such Licensed Content shall be licensed (and not assigned) to you in accordance with the terms of this Section 1.4. Subject to full payment of all amounts owed and this Agreement, TopCoder grants to you a non-exclusive, non-transferable license under TopCoder’s copyrights in the Licensed Content to copy, modify, prepare derivative works, distribute, publicly perform and publicly display the Licensed Content; provided, however, that you may not may not sublicense, distribute or resell the Licensed Content to any third party separate from or for use other than as incorporated into the Deliverables. TopCoder retains all right, title and interest in and to the Licensed Content. Any use of the Licensed Content beyond the scope of the licenses expressly granted herein is prohibited. You shall retain all copyright notices and authorship credits for the Licensed Content in the Deliverable and associated documentation. Nothing in this Agreement shall be construed so as to prohibit TopCoder from reusing any Licensed Content, whether existing before or developed during or after Deliverables. 

1.5 Third-Party Content. If you request that the Deliverables interface with, accompany, or include content or material not developed or licensed by TopCoder (“Third-Party Content”), any such Third-Party Content shall be subject to its own terms and conditions, and shall not be considered part of the Deliverables under this Agreement. You represent that you have all rights in the Third-Party Content specified or provided by you that are necessary to authorize its use in Competition Services and incorporation into the Deliverables. You agree to indemnify TopCoder for any breach of this indemnification.

2. DISCLAIMER OF WARRANTIES. To the extent permitted by law, the Deliverables and all TopCoder services are provided AS IS, WITH ALL FAULTS, and TOPCODER MAKES NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR IMPLIED, STATUTORY OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, OR FITNESS FOR A PARTICULAR PURPOSE, TITLE, OR NONINFRINGEMENT. No statement by TopCoder’s personnel or otherwise shall be deemed to be a warranty by TopCoder for any purpose or to give rise to any liability on the part of TopCoder unless contained in this Agreement. The parties acknowledge and agree that the fees charged by TopCoder under this Agreement reflect the allocation of risks provided by the foregoing warranty, the limitations of liability, and other terms set forth in this Agreement, and any modification of the allocation of risks would affect the fees charged.

3. PAYMENT. Payment will be required upon execution of a request for Competition Services. In the event that payment does not go through (for example, if a credit card payment is rejected) TopCoder may charge interest on overdue amounts at the rate of 1.5% per month or the highest lawful rate, whichever is less. You agree to pay to TopCoder all costs of collection of overdue amounts incurred by TopCoder. You shall be responsible for all taxes under this Agreement, except those taxes based on TopCoder’s income or payroll.

4. TERM AND TERMINATION. The Competition Services may be terminated by TopCoder at any time, and for any reason. Notwithstanding any termination of this Agreement, you shall remain obligated to pay all fees for competitions launched and services rendered prior to termination. Section 2 (Disclaimer of Warranties), Section 3 (Payment), Section 4 (Term and Termination), Section 5 (Limitation of Liability), Section 7 (Arbitration), Section 8 (Promotion), and Section 9 (General) of this Agreement shall survive any termination.

5. LIMITATION OF LIABILITY. NEITHER PARTY SHALL BE LIABLE TO THE OTHER, UNDER THIS AGREEMENT OR OTHERWISE FOR ANY CLAIM ARISING OUT OF OR RELATED TO A PARTY’S PERFORMANCE OF ITS OBLIGATIONS HEREUNDER, FOR ANY INCIDENTAL, PUNITIVE, SPECIAL, CONSEQUENTIAL OR OTHER INDIRECT DAMAGES, LOSS OF PROFITS, LOSS OF DATA OR USE OF DATA OR INTERRUPTION OF BUSINESS, EVEN IF SUCH PARTY OR ITS REPRESENTATIVE HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH LOSS. IN NO EVENT SHALL TOPCODER’S LIABILITY UNDER THIS AGREEMENT EXCEED THE FEES DUE OR PAYABLE UNDER THIS AGREEMENT FOR THE SERVICE GIVING RISE TO THE CLAIM.

6. CLAIMS OF INFRINGEMENT. If TopCoder becomes aware or reasonably believes that a Deliverable provided to you is or is likely to become, the subject of a claim of infringement, then TopCoder shall, at its option and expense either (i) procure for you the right to use the Deliverable or portion thereof, or (ii) replace or modify the Deliverable or portion thereof to make it non-infringing, or (iii) at TopCoder’s option, accept the return of the Deliverable (or the portion thereof), and refund the undepreciated portion of the fees paid by you for that Deliverable, assuming a 12-month straight-line depreciation schedule. THIS SECTION 6 STATES THE ENTIRE LIABILITY OF TOPCODER WITH RESPECT TO INFRINGEMENT OF INTELLECTUAL PROPERTY RIGHTS RELATED TO THE DELIVERABLES, LICENSED CONTENT OR THEIR USE. 

7. ARBITRATION OPTION. For any claim arising out of the services under this Agreement (excluding claims for injunctive or other equitable relief) where the total amount of the award sought is less than $10,000, the party requesting relief may elect to resolve the dispute in a cost effective manner through non-appearance-based arbitration. In the event a party elects arbitration, they shall initiate such arbitration through an established alternative dispute resolution (“ADR”) provider mutually agreed upon by the parties (such agreement not to be unreasonably withheld). The ADR provider and the parties must comply with the following rules: (i) the arbitration shall be conducted by telephone, online and/or be solely based on written submissions, the specific manner shall be chosen by the party initiating the arbitration; (ii) the arbitration shall not involve any personal appearance by the parties or witnesses unless mutually agreed by the parties; and (iii) any judgment on the award rendered by the arbitrator may be entered in any court of competent jurisdiction. All claims brought against TopCoder must be resolved in accordance with this section. All claims filed or brought contrary to this section shall be considered improperly filed and may be dismissed for failure to abide by the procedures set forth herein.

8. PROMOTION. You agree to be identified as a customer of TopCoder and grant TopCoder permission to refer to you or Your company by name, tradename and/or trademark, if applicable, and to briefly describe Your business in TopCoder’s marketing material, press releases and on its websites for the purpose of promoting Your relationship with TopCoder. The undersigned represents and warrants that s/he has the right to grant such permission, and that s/he is a duly authorized representative of and such company, and s/he is able to enter into and perform this Agreement.

9. GENERAL. This Agreement shall be governed in all respects by the laws of the State of Connecticut, USA without giving effect to principles of conflict of laws. The parties agree to submit to the jurisdiction of the Connecticut state and federal courts located in Hartford County, Connecticut for any claim relating to this Agreement which is not brought for arbitration pursuant to Section 7 above. The United Nations Convention for the International Sale of Goods shall not apply to this Agreement. All notices under this Agreement shall be in writing and shall be deemed to be made when delivered by overnight courier service to the Legal Department of such party at the address set forth on the first page of this Agreement, or to such other address as either party may specify by notice. If one party fails to enforce a provision of this Agreement, it shall not be precluded from enforcing the same provision at another time. If any provision of this Agreement is deemed unenforceable or invalid by law or by a court decision, the provision shall be changed and interpreted if possible to accomplish the intent of the provision within the constraints of the law. In the event the provision may not be so changed or interpreted, then only that provision, and not the entire agreement, shall be invalidated. Notwithstanding any provision to the contrary in this Agreement, if either party is prevented from complying, either totally or in part, with any of its obligations under this Agreement because of matters outside such party’s reasonable control (i.e., a force majeure event), then upon written notice to the other party, such obligations will be suspended during the period of such disability. Nothing contained in this Agreement shall be construed as creating any agency, partnership, or other form of joint enterprise between the parties. You may not assign this Agreement in whole or in part without the prior written consent of TopCoder. Subject to the foregoing, this Agreement shall be binding on the parties and their permitted assigns. Each party represents to the other party that it has the full corporate right, power and authority to enter into this Agreement and perform its obligations hereunder; and that when executed and delivered, this Agreement will constitute its legal, valid and binding obligation enforceable against it in accordance with its terms.]]>
           </mx:htmlText>
            </mx:TextArea>
            <mx:CheckBox id="termCheckBox" label="I have read and agree to these terms."/>
        </mx:VBox>
    </mx:VBox>
</mx:Canvas>
