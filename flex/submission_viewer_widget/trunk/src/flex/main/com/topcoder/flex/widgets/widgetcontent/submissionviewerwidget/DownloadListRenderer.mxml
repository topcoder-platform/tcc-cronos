<?xml version="1.0" encoding="utf-8"?>
<mx:HBox styleName="BoxStyle" xmlns:mx="http://www.adobe.com/2006/mxml">
	<mx:Script>
		<![CDATA[

			import mx.core.Application;

			private function getPurchase(dta:Object):String {
				if (!dta) {
					return "";
				}
				var temp:String = "";
				//if (dta.hasOwnProperty("size")) {
					down.label = "Download"
				//}
				if (dta.hasOwnProperty("purchased") && dta.purchased == true) {
					temp += "Prize: $";
				} else {
					temp += "Cost: $";
				}
				if (dta.hasOwnProperty("price")) {
					return temp + dta.price;
				} else {
					return "";
				}
			}
			
			private function getPurchased(dta:Object):String {
				if (!dta) {
					return "";
				}
				if (dta.hasOwnProperty("purchased") && dta.purchased == true) {
					return "Purchase: Yes";
				} else {
					return "Purchase: No";
				}
			}
			
			private function download(id:String):void {
				trace("Submission id @ download: " + id);

				// TODO: read url from app settings.				
				
				var url:String = "http://"+Application.application.parameters.hostAddress+"/direct/cockpit/impersonation/cockpitStudio.do?&sbmid=" + id + "&sbt=original";
        			var u:URLRequest = new URLRequest(url);
        			navigateToURL(u,"_blank");
				
				/*
				var request:URLRequest = new URLRequest(url);
				var fileRef:FileReference = new FileReference();
				fileRef.download(request);
				*/
			}
		]]>
	</mx:Script>
<mx:HBox styleName="BoxStyle" width="100%">
	<mx:VBox id="left" horizontalAlign="center" verticalGap="0"
			paddingTop="0" paddingLeft="0" paddingBottom="0" paddingRight="0">
		<mx:Canvas width="116" height="94">
			<mx:Canvas id="thumbnail" top="9" left="8" bottom="0" right="8"
				backgroundImage="{data.thumbnail}" backgroundSize="100%"/>
			<mx:Button styleName="rankLogo" buttonMode="true" id="rank" label="{(data.rank)?data.rank:'+'}"
				width="25" height="26" textAlign="center" />
		</mx:Canvas>
		<mx:Label id="content" textAlign="center" text="{'#' + data.id}" bottom="0" 
				fontWeight="bold" fontFamily="Arial" fontSize="12" />
		<mx:Label text="{getPurchase(data)}" textAlign="center" styleName="text" />
		<mx:Label text="{getPurchased(data)}" textAlign="center" styleName="text" />
	</mx:VBox>
	<mx:VBox id="right" width="100%" horizontalScrollPolicy="off" verticalScrollPolicy="off" >
		<mx:Label styleName="normalText" />
		<mx:Text width="100%" textAlign="left" styleName="text" 
				htmlText="" />
		<mx:Button id="down" buttonMode="true" styleName="ButtonStyle" label="Download" click="{download(data.id)}" />
	</mx:VBox>
</mx:HBox>
</mx:HBox>
